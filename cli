#!/usr/bin/env bash

# blogwriter CLI Tool
# Generated by Docker Project Builder

set -e

# Get script directory
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
PROJECT_ROOT="${SCRIPT_DIR}"

# Source common utilities
source "${SCRIPT_DIR}/bin/cli/common.sh"

show_help() {
    cat << EOF
blogwriter CLI - Docker Project Management Tool

Usage: ./cli [command] [options]

Commands:
    up          Start all containers
    down        Stop and remove containers
    clean       Remove containers, volumes, and local images
    build       Build or rebuild containers
    logs        View container logs
    exec        Execute a command in a container
    shell       Open a shell in a container
    status      Show container status
    restart     Restart containers
    db          Database commands (migrate, generate, push)
    certs       Generate SSL certificates (self-signed or Let's Encrypt)
    certs-renew Renew Let's Encrypt certificates
    help        Show this help message

Examples:
    ./cli up
    ./cli logs api
    ./cli shell nextjs
    ./cli exec api npm install
    ./cli db migrate
    ./cli db generate
    ./cli certs
    ./cli certs-renew

EOF
}

# Command dispatcher
COMMAND="${1:-help}"
shift || true

case "${COMMAND}" in
    up)
        source "${SCRIPT_DIR}/bin/cli/commands/up.sh"
        ;;
    down)
        source "${SCRIPT_DIR}/bin/cli/commands/down.sh"
        ;;
    clean)
        source "${SCRIPT_DIR}/bin/cli/commands/clean.sh"
        ;;
    build)
        source "${SCRIPT_DIR}/bin/cli/commands/build.sh"
        ;;
    logs)
        source "${SCRIPT_DIR}/bin/cli/commands/logs.sh"
        ;;
    exec)
        source "${SCRIPT_DIR}/bin/cli/commands/exec.sh"
        ;;
    shell)
        source "${SCRIPT_DIR}/bin/cli/commands/shell.sh"
        ;;
    status)
        source "${SCRIPT_DIR}/bin/cli/commands/status.sh"
        ;;
    restart)
        source "${SCRIPT_DIR}/bin/cli/commands/restart.sh"
        ;;
    db)
        source "${SCRIPT_DIR}/bin/cli/commands/db.sh"
        ;;
    certs)
        source "${SCRIPT_DIR}/bin/cli/commands/certs.sh"
        ;;
    certs-renew)
        source "${SCRIPT_DIR}/bin/cli/commands/certs-renew.sh"
        ;;
    help|--help|-h)
        show_help
        ;;
    *)
        error "Unknown command: ${COMMAND}"
        echo ""
        show_help
        exit 1
        ;;
esac
